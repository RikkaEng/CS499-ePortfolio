<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enhancement 1 - Rikka Eng</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-css.min.js"></script>
</head>
<body>

    <header>
        <h1>Rikka Eng</h1>
        <h2>Computer Science ePortfolio</h2>
        <nav>
            <a href="index.html">Home</a>
            <a href="code-review.html">Code Review</a>
            <a href="enhancement1.html">Enhancement 1: Software Design & Engineering</a>
            <a href="enhancement2.html">Enhancement 2: Algorithms & Data Structures</a>
            <a href="enhancement3.html">Enhancement 3: Databases</a>
        </nav>
    </header>
    <main>
        <section id="enhancement-header">
            <h2>Enhancement Three: Databases</h2>
            <div class="artifact-links">
                <h3>Artifact Files</h3>
                <ul>
                    <li><a href="artifacts/enhancement3-narrative.docx" download>üìÑ Download Original Milestone Word Document</a></li>
                    <li><a href="https://github.com/RikkaEng/CS465-travlr/tree/capstoneEnhancement" target="_blank">üíª View Full Project Code on GitHub</a></li>
                </ul>
            </div>
        </section>

        <section id="artifact-description">
        <h3>Artifact Descripiton</h3>
          <p>
            The artifact I‚Äôve selected for the database enhancement (enhancement three) is still the Travlr Getaways application 
            (i.e. MEAN-stack with MongoDB, Express, Angular, and Node). The project was still developed initially last semester in 
            CS-465 Full Stack Development last semester as an introduction to full-stack development. 
          </p>
          <p>
            In this enhancement I‚Äôve inspected the database operations and to list them, it uses MongoDB with Mongoose ODM, featuring 
            CRUD functionality for trip management, user authentication with JWT tokens, and a search system for filtering travel 
            packages.
          </p>
        </section>

      <section id="justification">
        <h3>Justification for Inclusion</h3>
        <p>
          I‚Äôm still choosing this artifact because it provides a diverse set of scenarios that can be reused for all of the proposed 
          enhancement, implementing database security measures in this case can be done via handling user data, or within the database 
          itself. The original implementation was functional, but it had several vulnerabilities that were exploitable in early-stage applications: 
          there was a lack of input sanitizations and no validation methods against NoSQL injection attacks, and insufficient data integrity enforced. 
        </p>
        <h4 style="margin-bottom: 20px;">What I did Specifically:</h4>
        <ul style="margin-left: 40px;">
          <li>
            <strong>NoSQL Injection Sanitization:</strong> I Implemented the express-mongo-sanitize middleware throughout the application. This 
            addresses a critical security vulnerability where malicious users could manipulate database queries by injection MongoDB operations 
            (like $ne, $gt, $where) through user input. The middleware automatically strips these operators from incoming requests before they reach 
            the database layer.
          </li>
          <li>
            <strong>Regex Injection Protection: </strong> The search function also had a vulnerability because it used user inputs directly and that‚Äôs 
            not ideal for MongoDB regex queries. I added a validation check to avoid malicious stuff like DOS attacks or corrupted query behavior.
          </li>
            <p>
                <code>const sanitizedTerm = searchTerm.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');</code>
            </p>
          <li>
            <strong>Schema Validation: </strong> At first, I messily added another method into the controller but felt I could reduce the amount of 
            spaghetti code, and opted to instead enhance the Mongoose schema to enforce data integrity within itself. It‚Äôs basically separation of 
            concerns; the controller should focus on request/response handling, and the schema cannot only just be the structure of the data but now 
            includes:
          </li>
              <ul style="margin-left: 40px;">
                <li>Type Enforcement (converting perPerson from a String to a Number)</li>
                <li>Required field validation with custom error messages</li>
                <li>Maximum length constraints to prevent database bloat</li>
                <li>Minimum value constraints for numeric fields</li>
                <li>Automatic whitespace trimming</li>
                <li>Unique constraints on trip codes</li>
              </ul>
        </ul>
          
      </section>
        <section id="reflection">
            <h2>Reflection on Enhancement Process:</h2>
            <h3>What I Learned:</h3>
            <p>
                I learned some insight from this enhancement, embarrassingly I came across a conundrum in the distinction between sanitization and validation. 
                I initially assumed that MongoDB‚Äôs sanitization installed application was an all-in-one security solution, but learned that it specifically 
                addressed NoSQL injections by removing dangerous operators. Input validation serves a different purpose, ensuring data quality and business 
                logic compliance. Modern applications need both layers working together.
            </p>
            <p>
                I also gained practical experience with Mongoose schema validation, which I had used superficially in the original project. Moving validation 
                logic from controllers to the schema significantly reduced code duplication and made the application more maintainable. The automatic enforcement 
                of validation rules means that any future code paths that save or update trips will benefit from these safeguards without additional implementation 
                work. 
            </p>
            <h3>Challenges:</h3>
            <p>
                A small hiccup I ran into was the initial implementation of input validation; it broke the Angular admin interface. Trips would no longer display after 
                attempting to add new ones. I went back to my initial changes, and mainly looked at tripAddTrips in app_api/controllers/trip.js, which I assumed is where 
                the problem started since this only occurred after I attempted to add a trip. Through some trial and error (I assumed the newly added validators were 
                the problem so I commented them out) and found that the application was now working, my validators were clearly causing a problem. I assumed my validation 
                rules were too strict, retracting legitimate data from the Angular forms because some optional fields were being sent as empty strings rather than 
                undefined values. I went for more reasonable values:
            </p>
            <ul style="margin-left: 40px;">
                <li>
                    Optional fields that might be empty strings
                </li>
                <li>
                    Numbers that might be sent as strings from forms
                </li>
                <li>
                    Distinguishing between ‚Äúmissing required data‚Äù and ‚Äúdata in wrong format‚Äù
                </li>
            </ul>

            <h3>Course OUtcomes:</h3>
            <p>
                <strong>Outcome 1 ‚Äì Collaborative Environments: </strong>Not directly addressed in this enhancement. While the implementation follows industry-standard practices 
                that would facilitate team collaboration (clear code structure, separation of concerns), this artifact doesn not demonstrate specifc collaborative workflows, 
                stakeholder communication, or decision documentation. This outcome is better addressed through my code review process and ePortfolio presentation as a whole.
            </p>
            <p>
                <strong>Outcome 2 - Professional Communication</strong>Partially addressed through this assignment, which demonstrates my ability to explain technical security 
                implementations in clear, accessible language appropriate for both technical and non-technical audiences. The narrative balances technical precision (explaining 
                NoSQL injection mechanics) with readability (using analogies like ‚Äúlayered defenses‚Äù). However, the artifact itself does not include extensive visual documentation 
                or stakeholder-facing communication materials.
            </p>
            <p>
                <strong>Outcome 3 ‚Äì Algorithmic Solutions: </strong>Not directly addressed in this enhancement. While the search functionality uses regex pattern matching, the focus 
                of this enhancement was on security and data integrity rather than algorithmic optimization or complexity analysis. The enhancements prioritized correctness and security 
                over performance trade-offs. This outcome is better demonstrated in my algorithms and data structures artifacts.
            </p>
            <p>
                <strong>Outcome 4 ‚Äì Techniques, Skills & Tools:</strong> The main thing addressed, I demonstrated the use of well-known techniques:
            </p>
            <ul style="margin-left: 40px;">
                <li>
                    <strong>Tools: </strong>I implemented express-mongo-sanitize middleware leveraged Mongoose ODM‚Äôs built-in validation system.
                </li>
                <li>
                    <strong>Techniques: </strong>I applied separation of concerns (initially I made an extra method in the controllers folder, which created some bloated spaghetti code, 
                    so I moved the validation methods straight to the schema folder), and implemented defense-in-debth security, used proper error handling patterns.
                </li>
                <li>
                    <strong>Best Practices: </strong>Followed OWASP guidelines for preventing NoSQL injections, implemented input validation consistent with database design standards.
                </li>
            </ul>
            <p>
                <strong>Outcome 5 - Security Mindset:</strong> Also mainly addressed, the enhancement explicitly focused on anticipating and mitigating adversarial exploits:
            </p>
            <ul <ul style="margin-left: 40px;">
                <li>
                    Identified NoSQL injection vulnerabilities where attackers could manipulate queries using operators like $ne or $gt.
                </li>
                <li>
                    Recognized regex injection attack vector in the search functionality.
                </li>
                <li>
                    Implemented multiple layers of defense (sanitization middleware, input validation, schema constraints)
                </li>
                <li>
                    Applied secure error handling that provides useful feedback without leaking system information.
                </li>
                <li>
                    Followed the principle of least privilege by validating all user inputs before database operations.
                </li>
            </ul>

            <h3>Summary</h3>
            <p>
                In this enhancement I added a few security features to a functional MEAN-stack application, removing various vulnerabilities: Middleware sanitizations, controller 
                validation, and schema enforcement, where multiple security mechanisms work together rather than relying on a single point of protection. I also cleaned up the code a 
                bit, with validation logic properly separated from business logic and placed into the schema, also makes the application more maintainable and easier to extend in the 
                future. 
            </p>
            
        </section>

    </main>
    <footer>
        <p>¬© 2024 Rikka Eng | <a href="https://github.com/RikkaEng/CS499-ePortfolio">GitHub</a></p>
    </footer>

</body>
</html>
